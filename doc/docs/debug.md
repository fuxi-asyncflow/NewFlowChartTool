# 流程图的调试

流程图的调试是指可以将游戏内流程图的运行状态实时显示在工具中。包括各节点的运行状态与计数，流程图中变量的实时数据。

流程图的调试功能仅用于平时的开发过程中，需要在编译 Runtime 时，打开调试功能，注意外网版本请不要打开调试功能。

## 调试功能

### 调试窗口

单击工具栏中的调试按钮即可打开调试窗口，它的主要作用是获取游戏中满足条件的流程图信息。

需要设置的信息有游戏进程中 Runtime 使用的 IP 与端口范围。注意这里的端口并非部分游戏GM工具使用的端口。

此外当游戏中运行的流程图数量太多时，可以设置一些过滤条件，包含对象的名称或是流程图的名称，以减少显示的流程图数量。

点击刷新按钮即可获取到游戏内的流程图列表，双击其中任一项即可开始对该流程图的调试。

### 快速调试

由于开发过程中，通常都是想对当前打开的流程图进行调试，为此工具提供了快速调试的功能。

当点击工具栏中的快速调试按钮时，工具会自动连接当前调试窗口中配置的IP与端口的游戏进程，并获取游戏中当前流程图的运行信息。

- 如果游戏中当前流程图处于运行状态，那么就直接进入调试状态。如果有当前流程图有多个流程图处于运行状态，那么会调试获取到的第一条流程图信息
- 如果游戏中当前流程图没有处于运行状态，工具也会进入调试状态。一旦游戏中该流程图开始运行，就会立刻将流程图的运行信息发送给工具

!!! note
    由于流程图调试状态中显示的节点的运行次数是从调试开始的时刻进行统计的，所以如果在流程图开始运行之后才进行调试，显示的计数是少于实际运行的计数的。
    
    如果需要准确的统计数据，就需要在流程图运行之前，以快速调试的方式来进行调试。

## 回放

流程图工具提供了回放的功能。每当工具栏中的停止调试按钮按下时，工具会自动将本次调试过程中收到的信息保存在工具目录下的的debug文件中。

调试窗口中的回放按钮，可以选择回放文件并列出其中包含的流程图信息，双击流程图即可进入回放模式。

此时流程图上方会出现一些回放的控制按钮，以及一个进度条。通过它们可以播放或跳转到相应的时刻来查看流程图的运行状态。

## 热更新

热更新是指策划在编辑流程图时，可以实时更新流程图到游戏进程中以查看效果。

热更新的操作十分简单，只需要点击工具栏中的热更新按钮，即可将当前流程图热更新到游戏中。热更新的时候，会自动停止并重新运行游戏中的该流程图。

## patch

流程图可以生成 patch 文件用于线上的补丁操作。(暂未实现)

patch 功能与热更新的原理类似，区别在于热更新功能是通过流程图工具，直接将patch数据发送给 runtime 进行更新。而 patch 则只负责生成 patch 文件，由游戏方来负责进行更新。